<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <title>Konfuzio AI Comedy Club</title>

    <style>
    	#video {
    		transform: rotateY(180deg);
    		-webkit-transform:rotateY(180deg); /* Safari and Chrome */
    		-moz-transform:rotateY(180deg); /* Firefox */
    		
    	}
    </style>
    <script
      src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.0.3/socket.io.js"></script>

      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <script>
        $(function() {
          // Function to fetch the joke using async/await
          async function fetchJoke() {
            try {
              // Make the AJAX GET request to the Flask backend
              const response = await $.getJSON('/background_process_test');
              return response.joke; // Return the joke data
            } catch (error) {
              console.error('Error fetching the joke:', error);
              return null; // Return null in case of an error
            }
          }
      
          // Attach a click event handler to the button with ID "test"
          $('#test').on('click', async function(e) {
            e.preventDefault(); // Prevent the default behavior of the link
      
            console.log('Button clicked!');
      
            // Fetch the joke using the async function
            const joke = await fetchJoke();
      
            // Update the "joker" paragraph with the joke text
            $('#joker').text(joke || 'Failed to fetch the joke.');
          });
        });
      </script>
  </head>

  <body>

    <div id="container">
      <video autoplay playsinline id="videoElement"></video>
      <canvas id="canvas" width="400" height="300"></canvas>
    </div>

    <div class= 'video'>
      <img id="photo" width="400" height="300">
      <!-- <h1>video</h1> -->
    </div>
    <script  src="{{ url_for('static',filename='script.js') }}"></script>

    <div class='container'>
      <h3>Comedy stage</h3>
        <p id="joker"></p>
          <form>
              <a href=# id=test><button class='btn btn-default'>Press for a joke</button></a>
          </form>
    </div>

  </body>

</html>